[Description]
On Verizon 5G Home LVSKIHP OutDoorUnit (ODU) 3.33.101.0 devices, the RPC endpoint crtc_fw_upgrade provides a means of provisioning a firmware update for the device. /lib/functions/wnc_jsonsh/wnc_crtc_fw.sh has no cryptographic validation of the image, thus allowing an attacker to modify the installed firmware.

[Additional Information]
This vulnerability has been patched on firmware 5.33.141.0. The vulnerable endpoint requires the use of a set of certificates that is embedded in the firmware provisioned to all devices in the fleet (see CVE-2022-28371 for details).

[Vulnerability Type]
Download of Code Without Integrity Check

[Vendor of Product]
Verizon / Wistron Neweb Corporation

[Affected Product Code Base]
Verizon 5G Home Internet Modem/Router LVSKIHP - 3.33.101.0 (ODU)

[Affected Component]
Line 61 of OutDoorUnit file /lib/functions/wnc_jsonsh/wnc_crtc_fw.sh: 
   res=`JsonClient -r /tmp/cgi-2-sys set_firmware_ugprade_manual '{"file_name":"/reserved/firmware.img"}'`

[Attack Type]
Remote

[Impact]
Code Execution
Denial of Service
Full modification of device firmware

[Attack Vectors]
An attacker must invoke the crtcrpc endpoint "crtc_fw_upgrade" with a maliciously provided package.

[Discoverers]
Matthew Lichtenberger, Shea Polansky